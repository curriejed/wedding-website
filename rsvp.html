<section id="rsvp" class="card">
  <h2>RSVP</h2>
  <p>Please RSVP by <strong>[insert date]</strong>. We can‚Äôt wait to celebrate with you!</p>

  <form id="rsvpForm" class="rsvp-form">
    <label>
      Your name
      <input type="text" name="name" required />
    </label>

    <label>
      Email (so we can confirm)
      <input type="email" name="email" required />
    </label>

    <fieldset>
      <legend>Will you be attending?</legend>
      <label><input type="radio" name="attending" value="Yes" required /> Yes üéâ</label>
      <label><input type="radio" name="attending" value="No" /> No üò¢</label>
    </fieldset>

    <label>
      Number of guests (including you)
      <select name="guest_count" required>
        <option value="">Choose‚Ä¶</option>
        <option value="1">1</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
      </select>
    </label>

    <label>
      Meal choice
      <select name="meal" required>
        <option value="">Choose one‚Ä¶</option>
        <option value="Chicken">Chicken</option>
        <option value="Beef">Beef</option>
        <option value="Vegetarian">Vegetarian</option>
      </select>
    </label>

    <fieldset>
      <legend>Dietary restrictions (if any)</legend>
      <label><input type="checkbox" name="dietary" value="Gluten-free" /> Gluten-free</label>
      <label><input type="checkbox" name="dietary" value="Dairy-free" /> Dairy-free</label>
      <label><input type="checkbox" name="dietary" value="Nut allergy" /> Nut allergy</label>
      <label><input type="checkbox" name="dietary" value="Other" /> Other</label>
    </fieldset>

    <label>
      Notes / allergies / anything else?
      <textarea name="notes" rows="3"></textarea>
    </label>

    <input type="text" name="_gotcha" style="display:none" />

    <button type="submit">Send RSVP</button>
    <p id="formStatus" class="form-hint"></p>
  </form>
</section>

<script>
  const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxRxJ0TxnBKGnUy7KaoM9x5GEcI7jM13agrjzR8HR8G8SVcU8SWC1Q8lQXOSzo8knP-/exec";
  const form = document.getElementById("rsvpForm");
  const statusEl = document.getElementById("formStatus");

  form.addEventListener("submit", async (e) => {
    e.preventDefault();
    statusEl.textContent = "Sending‚Ä¶";

    try {
      const formData = new FormData(form);

      const res = await fetch(SCRIPT_URL, {
        method: "POST",
        body: formData,
      });

      const text = await res.text();
      // If response isn't JSON for some reason, still treat as success if HTTP ok
      if (res.ok) {
        statusEl.textContent = "Thanks! Your RSVP has been recorded ‚ù§Ô∏è";
        form.reset();
      } else {
        statusEl.textContent = "Hmm‚Äîsomething went wrong. Please try again.";
        console.error(text);
      }
    } catch (err) {
      statusEl.textContent = "Network error‚Äîplease try again.";
      console.error(err);
    }
  });
</script>
